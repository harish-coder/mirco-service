package com.example.poc.employee.dao;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.transaction.Transactional;

import org.springframework.stereotype.Repository;

import com.example.poc.employee.constant.GenericConstant;
import com.example.poc.employee.entity.DataTableColumnEntity;
import com.example.poc.employee.projection.AvaliableColumnDto;
import com.example.poc.employee.projection.VisibleColumnDto;

@Repository
@Transactional
public class DataTableColumnDao {
	
	@PersistenceContext
	private EntityManager entityManager;

	public List<AvaliableColumnDto> getAvaliableColumnInfo(){
		StringBuilder query = new StringBuilder();
		query.append("select  new com.example.poc.employee.projection.AvaliableColumnDto(dataTableColumn.columnName) from "+
		DataTableColumnEntity.class.getName()+" dataTableColumn "
		+ " where dataTableColumn.tableId="+GenericConstant.EMPLOYEE_TABLE+" and dataTableColumn.columnStatus="+GenericConstant.AVALIABLE_COLUMN);
		List<AvaliableColumnDto> avaliableListInfo=  entityManager.createQuery(query.toString(),AvaliableColumnDto.class).getResultList();
		return (List<AvaliableColumnDto>) avaliableListInfo;
	}
	
	
	public List<VisibleColumnDto> getVisibleColumnInfo(){
		StringBuilder query = new StringBuilder();
		query.append("select  new com.example.poc.employee.projection.VisibleColumnDto(dataTableColumn.columnName) from "+
		DataTableColumnEntity.class.getName()+" dataTableColumn "
		+ " where dataTableColumn.tableId="+GenericConstant.EMPLOYEE_TABLE+" and dataTableColumn.columnStatus="+GenericConstant.VISIBLE_COLUMN);
		List<VisibleColumnDto> visibleColumnInfo=  entityManager.createQuery(query.toString(),VisibleColumnDto.class).getResultList();
		return (List<VisibleColumnDto>) visibleColumnInfo;
	}
}
